!function(){"use strict";function t(r,e){return t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},t(r,e)}let r=function(r){function e(t){var e;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;return(e=r.call(this,t,i,a,n)||this).parent=t,e.field=i,e.params=a,e.setValue=n,e.changes=[],e.passReadies=!0,e.$container=H5P.jQuery("<div>",{class:"h5peditor-tabs"}),e.libraryTabs=new H5PEditor.widgets[e.field.type](e.parent,e.field,e.params,e.setValue),e.libraryTabs.appendTo(e.$container),e.$select=e.libraryTabs.$select,e.params=e.libraryTabs.params,e.libraries=e.libraryTabs.libraries,e.metadataForm=e.libraryTabs.metadataForm,e.libraryTabs.change((()=>{e.libraries=e.libraryTabs.libraries,e.metadataForm=e.libraryTabs.metadataForm,e.sanitizeColumnOptions();const t=e.findTabsIds();t.length>0&&(e.sanitizeColumnParams(t),e.sanitizeColumnDOM(t))})),e.libraryTabs.changes&&e.libraryTabs.changes.push((()=>{e.handleFieldChange()})),e.$errors=e.$container.find(".h5p-errors"),e}var i,a;a=r,(i=e).prototype=Object.create(a.prototype),i.prototype.constructor=i,t(i,a);var n=e.prototype;return n.appendTo=function(t){this.$container.appendTo(t)},n.validate=function(){let t=!0;return this.libraryTabs.children[0].forEachChild((r=>{t=t&&r.validate()})),t},n.remove=function(){},n.handleFieldChange=function(){this.params=this.libraryTabs.params,this.changes.forEach((t=>{t(this.params)}))},n.sanitizeColumnOptions=function(){this.libraryTabs?.children?.length&&this.libraryTabs.children[0].forEachChild((t=>{const r=H5PEditor.findField("content",t);r.field.options=r.field.options.filter((t=>-1===t.indexOf("H5P.Tabs ")));const e=r.$select.get(0);this.waitForColumnOptions(e,200,(()=>{for(let t=e.children.length-1;t>=1;t--)-1!==e.children[t].value.indexOf("H5P.Tabs ")&&e.removeChild(e.children[t])}))}))},n.waitForColumnOptions=function(t,r,e){"function"==typeof e&&t&&(("number"!=typeof r||r<100)&&(r=200),1===t.children.length?setTimeout(this.waitForColumnOptions,r,t,r,e):e())},n.findTabsIds=function(){const t=this.libraryTabs?.params?.params?.content;if(!t)return[];const r=[];for(let e=t.length-1;e>=0;e--)-1!==t[e].content?.library?.indexOf("H5P.Tabs ")&&r.push(e);return r},n.sanitizeColumnParams=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const r=this.libraryTabs?.params?.params?.content;r&&(this.libraryTabs.params.params.content=r.filter(((r,e)=>-1===t.indexOf(e))))},n.sanitizeColumnDOM=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const r=this.libraryTabs.$libraryWrapper.get(0).querySelector(".list > .h5peditor-widget-wrapper > ul");r.childNodes&&t.forEach((t=>{this.libraryTabs.children[0].removeItem(t),r.childNodes.length>t&&r.removeChild(r.childNodes[t])}))},e}(H5PEditor.Library);H5PEditor.widgets.editorTabs=r}();