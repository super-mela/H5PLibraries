!function(){"use strict";let t=function(){function t(){}return t.extend=function(){for(let t=1;t<arguments.length;t++)for(let e in arguments[t])Object.prototype.hasOwnProperty.call(arguments[t],e)&&("object"==typeof arguments[0][e]&&"object"==typeof arguments[t][e]?this.extend(arguments[0][e],arguments[t][e]):arguments[0][e]=arguments[t][e]);return arguments[0]},t.htmlDecode=function(t){return(new DOMParser).parseFromString(t,"text/html").documentElement.textContent},t.stripHTML=function(t){const e=document.createElement("div");return e.innerHTML=t,e.textContent||e.innerText||""},t.formatLanguageCode=function(t){if("string"!=typeof t)return t;const e=t.split("-");return e[0]=e[0].toLowerCase(),e.length>1&&(e[1]=e[1].toUpperCase()),t=e.join("-")},t.addMixins=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!t.prototype)return;Array.isArray(e)||(e=[e]);const n=t.prototype;e.forEach((t=>{const e=t.prototype;Object.getOwnPropertyNames(e).forEach((t=>{"constructor"!==t&&(Object.getOwnPropertyNames(n).includes(t)||(n[t]=e[t]))}))}))},t}();var e=t;let n=function(){function t(){}var e=t.prototype;return e.getInstances=function(){return this.contents.map((t=>t.instance))},e.getInstancesSemantics=function(){return this.params.contents.map((t=>t.content))},t}(),i=function(){function t(){}var e=t.prototype;return e.getAnswerGiven=function(){return this.contents.some((t=>"function"==typeof t?.instance?.getAnswerGiven&&t.instance.getAnswerGiven()))},e.getScore=function(){return this.contents.reduce(((t,e)=>t+("function"==typeof e.instance.getScore?e.instance.getScore():0)),0)},e.getMaxScore=function(){return this.contents.reduce(((t,e)=>t+("function"==typeof e.instance.getMaxScore?e.instance.getMaxScore():0)),0)},e.showSolutions=function(){this.contents.forEach((t=>{"function"==typeof t?.instance?.showSolutions&&t.instance.showSolutions()})),this.trigger("resize")},e.resetTask=function(){this.contents.forEach((t=>{"function"==typeof t?.instance?.resetTask&&t.instance.resetTask(),t.isDone=!t.instance||!this.isInstanceTask(t.instance)})),this.trigger("resize")},e.getXAPIData=function(){var t=this.createXAPIEvent("answered");return t.data.statement.object.definition.interactionType="compound",t.setScoredResult(this.getScore(),this.getMaxScore(),this,!0,this.getScore()===this.getMaxScore()),{statement:t.data.statement,children:this.getXAPIDataFromChildren(this.contents.map((t=>t.instance)))}},e.getCurrentState=function(){return{children:this.contents.map((t=>"function"==typeof t?.instance?.getCurrentState?t.instance.getCurrentState():{}))}},t}(),o=function(){function t(){}var n=t.prototype;return n.getXAPIDataFromChildren=function(t){return t.map((t=>{if("function"==typeof t.getXAPIData)return t.getXAPIData()})).filter((t=>!!t))},n.createXAPIEvent=function(t){const n=this.createXAPIEventTemplate(t);return e.extend(n.getVerifiedStatementValue(["object","definition"]),this.getxAPIDefinition()),n},n.getxAPIDefinition=function(){const t={name:{}};return t.name[this.languageTag]=this.getTitle(),t.name["en-US"]=t.name[this.languageTag],t.description={},t.description[this.languageTag]=e.stripHTML(this.getDescription()),t.description["en-US"]=t.description[this.languageTag],t.type="http://adlnet.gov/expapi/activities/cmi.interaction",t.interactionType="other",t},n.getTitle=function(){return H5P.createTitle(this.extras?.metadata?.title||t.DEFAULT_DESCRIPTION)},n.getDescription=function(){return t.DEFAULT_DESCRIPTION},t}();function r(t,e){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},r(t,e)}o.DEFAULT_DESCRIPTION="Portfolio chapter";let s=function(t){var s,a;function c(r,s){var a;let u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};a=t.call(this)||this,e.addMixins(c,[n,i,o]),a.params=e.extend({chapter:{contents:[]}},r),a.params=a.params.chapter,a.contentId=s,a.extras=u,a.previousState=u?.previousState||{};const p=u?.metadata?.defaultLanguage||"en";for(a.languageTag=e.formatLanguageCode(p);a.params.contents.length<1;)a.params.contents.push({});return a.contents=a.buildContents({contents:a.params.contents,previousStates:a.previousState.children||[]}),a.isTask=a.contents.some((t=>a.isInstanceTask(t.instance))),"function"==typeof a.isRoot&&a.isRoot()&&a.setActivityStarted(),a}a=t,(s=c).prototype=Object.create(a.prototype),s.prototype.constructor=s,r(s,a);var u=c.prototype;return u.attach=function(t){t.get(0).classList.add("h5p-portfolio-chapter"),t.get(0).appendChild(this.buildDOM()),window.requestAnimationFrame((()=>{window.requestAnimationFrame((()=>{this.trigger("resize")}))}))},u.buildContents=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(t.contents||[]).map(((e,n)=>{const i=this.buildContentWrapper(),o=t?.previousStates.length>n?t.previousStates[n]:{},r=this.createChildInstance(e,i,n,o);return{dom:i,instance:r,isDone:!r||!this.isInstanceTask(r)}}))},u.createChildInstance=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const o=t.content?H5P.newRunnable(t.content,this.contentId,H5P.jQuery(e),!1,{previousState:i}):null;return o&&(this.initializeResizeBubbling(o),this.isInstanceTask(o)&&o.on("xAPI",(t=>{this.trackScoring(t,n)}))),o},u.initializeResizeBubbling=function(t){this.bubbleDown(this,"resize",[t]),this.bubbleUp(t,"resize",this)},u.buildDOM=function(){const t=document.createElement("div");return t.classList.add("h5p-portfolio-chapter-contents"),this.contents.forEach((e=>{t.appendChild(e.dom)})),t},u.getPlaceholderDOMs=function(){return this.contents.map((t=>t.dom))},u.buildContentWrapper=function(){const t=document.createElement("div");return t.classList.add("h5p-portfolio-chapter-content"),t},u.bubbleDown=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];t.on(e,(function(i){t.bubblingUpwards||n.forEach((t=>{t.trigger(e,i)}))}))},u.bubbleUp=function(t,e,n){t.on(e,(t=>{n.bubblingUpwards=!0,n.trigger(e,t),n.bubblingUpwards=!1}))},u.trackScoring=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;t&&null!==t.getScore()&&(e<0||e>this.contents.length-1||(this.contents[e].isDone=!0,this.contents.every((t=>t.isDone))&&this.handleAllContentsDone()))},u.handleAllContentsDone=function(){window.requestAnimationFrame((()=>{this.triggerXAPIScored(this.getScore(),this.getMaxScore(),"completed")}))},u.isInstanceTask=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!t)return!1;if(t.isTask)return t.isTask;return!("function"!=typeof t.getMaxScore)},c}(H5P.EventDispatcher);H5P.PortfolioChapter=s}();