!function(){"use strict";const e=Math.PI/2;let t=function(){function e(){}return e.extend=function(){for(let e=1;e<arguments.length;e++)for(let t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&("object"==typeof arguments[0][t]&&"object"==typeof arguments[e][t]?this.extend(arguments[0][t],arguments[e][t]):arguments[0][t]=arguments[e][t]);return arguments[0]},e.addMixins=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!e.prototype)return;Array.isArray(t)||(t=[t]);const o=e.prototype;t.forEach((e=>{const t=e.prototype;Object.getOwnPropertyNames(t).forEach((e=>{"constructor"!==e&&(Object.getOwnPropertyNames(o).includes(e)||(o[e]=t[e]))}))}))},e.toRad=function(e){return e*(Math.PI/180)},e}();function o(e,t){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},o(e,t)}let n=function(e){var n,i;function s(o,n){var i;let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(i=e.call(this)||this).element=o,i.camera=n,i.options=t.extend({friction:800,shouldInvert:!1,isCamera:!1,isPanorama:!1},s),i.invert=s.shouldInvert?1:-1,i.alpha=0,i.beta=0,i.keyStillDown=null,["handleMouseDown","handleMouseMove","handleMouseUp","handleTouchStart","handleTouchMove","handleTouchEnd","handleKeyDown","handleKeyUp","handleFocus"].forEach((e=>{i[e]=i[e].bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(i))})),o.setAttribute("tabindex","0"),o.addEventListener("mousedown",i.handleMouseDown,!1),o.addEventListener("touchstart",i.handleTouchStart,!1),o.addEventListener("keydown",i.handleKeyDown,!1),o.addEventListener("focus",i.handleFocus,!1),o.setAttribute("role","application"),i}i=e,(n=s).prototype=Object.create(i.prototype),n.prototype.constructor=n,o(n,i);var r=s.prototype;return r.getAlpha=function(){return this.alpha},r.getBeta=function(){return this.beta},r.isMoving=function(e){return e?this.controlActive===e:!!this.controlActive},r.setPanorama=function(e){"boolean"==typeof e&&(this.options.isPanorama=e)},r.start=function(e,t,o,n){if(this.controlActive)return!1;const i={element:this.element,isCamera:this.options.isCamera};n&&(i.target=n.target);const s=new H5P.Event("movestart",i);return s.defaultPrevented=!1,this.trigger(s),!s.defaultPrevented&&(this.startPosition={x:e,y:t},this.alpha=0,this.beta=0,this.controlActive=o,!0)},r.end=function(){this.element.classList.remove("dragging"),this.controlActive=!1,this.trigger("movestop")},r.move=function(e,t,o){const n=new H5P.Event("move");if(this.camera?.fov){const e=this.options.isPanorama?53:75;o/=this.camera.fov/e}n.alphaDelta=e/o,n.betaDelta=t/o,this.alpha=(this.alpha+n.alphaDelta)%(2*Math.PI),this.beta=(this.beta+n.betaDelta)%(2*Math.PI);const i=Math.PI/2;this.beta=Math.max(-i,Math.min(this.beta,i)),n.alpha=this.alpha,n.beta=this.beta,this.trigger(n)},r.handleMouseDown=function(e){0===e.button&&this.start(e.pageX,e.pageY,"mouse",e)&&(e.stopPropagation(),window.addEventListener("mousemove",this.handleMouseMove,!1),window.addEventListener("mouseup",this.handleMouseUp,!1))},r.handleMouseMove=function(e){let t=e.movementX,o=e.movementY;void 0!==e.movementX&&void 0!==e.movementY||(this.prevPosition||(this.prevPosition={x:this.startPosition.x,y:this.startPosition.y}),t=e.pageX-this.prevPosition.x,o=e.pageY-this.prevPosition.y,this.prevPosition={x:e.pageX,y:e.pageY}),0===t&&0===o||this.move(t,o,this.options.friction)},r.handleMouseUp=function(){this.prevPosition=null,window.removeEventListener("mousemove",this.handleMouseMove,!1),window.removeEventListener("mouseup",this.handleMouseUp,!1),this.end()},r.handleTouchStart=function(e){this.start(e.changedTouches[0].pageX,e.changedTouches[0].pageY,"touch")&&(this.element.addEventListener("touchmove",this.handleTouchMove,!1),this.element.addEventListener("touchend",this.handleTouchEnd,!1))},r.handleTouchMove=function(e){if(!e.cancelable)return;if(e.touches.length>1)return;e.preventDefault(),e.stopPropagation(),this.prevPosition||(this.prevPosition={x:this.startPosition.x,y:this.startPosition.y});const t=e.changedTouches[0].pageX-this.prevPosition.x,o=e.changedTouches[0].pageY-this.prevPosition.y;this.prevPosition={x:e.changedTouches[0].pageX,y:e.changedTouches[0].pageY},this.move(t,o,this.options.friction*s.FRICTION_FACTOR_TOUCH)},r.handleTouchEnd=function(){this.prevPosition=null,this.element.removeEventListener("touchmove",this.handleTouchMove,!1),this.element.removeEventListener("touchend",this.handleTouchEnd,!1),this.end()},r.handleKeyDown=function(e){if(!["ArrowLeft","Numpad4","ArrowRight","Numpad6","ArrowUp","Numpad8","ArrowDown","Numpad2"].includes(e.code))return;if(null===this.keyStillDown&&this.start(0,0,"keyboard")&&(this.keyStillDown=e.code,this.element.addEventListener("keyup",this.handleKeyUp,!1)),e.preventDefault(),e.stopPropagation(),this.keyStillDown!==e.code)return;const t={x:0,y:0};switch(e.code){case"ArrowLeft":case"Numpad4":t.x+=this.invert;break;case"ArrowUp":case"Numpad8":t.y+=this.invert;break;case"ArrowRight":case"Numpad6":t.x-=this.invert;break;case"ArrowDown":case"Numpad2":t.y-=this.invert}this.move(t.x,t.y,this.options.friction*s.FRICTION_FACTOR_KEYBOARD)},r.handleKeyUp=function(){this.keyStillDown=null,this.element.removeEventListener("keyup",this.handleKeyUp,!1),this.end()},r.handleFocus=function(e){e.preventDefault(),e.target.focus({preventScroll:!0})},s}(H5P.EventDispatcher);function i(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e,t){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},s(e,t)}n.FRICTION_FACTOR_KEYBOARD=.025,n.FRICTION_FACTOR_TOUCH=.75;let r=function(e){var t,o;function n(t,o,n,s){var r;return(r=e.call(this)||this).object=t,r.element=void 0!==o?o:document,r.minFov=15,r.maxFov=n?53:75,r.minZoom=1,r.maxZoom=15,r.zoomPercentage=0,r.enableZoom=s,r.zoomSpeed=2.5,r.dollyStart=new H5P.ThreeJS.Vector2,r.dollyEnd=new H5P.ThreeJS.Vector2,r.dollyDelta=new H5P.ThreeJS.Vector2,o.addEventListener("wheel",r.handleMouseWheel.bind(i(r)),!1),o.addEventListener("touchstart",r.handleTouchStart.bind(i(r)),!1),o.addEventListener("touchmove",r.handleTouchMove.bind(i(r)),!1),o.addEventListener("keydown",r.handleKeyDown.bind(i(r)),!1),r}o=e,(t=n).prototype=Object.create(o.prototype),t.prototype.constructor=t,s(t,o);var r=n.prototype;return r.setEnableZoom=function(e){this.enableZoom=e},r.setMaxFov=function(e){this.maxFov=e},r.setZoomPercentage=function(){this.object.isPerspectiveCamera?this.zoomPercentage=100-Math.round((this.object.fov-this.minFov)/(this.maxFov-this.minFov)*100):this.zoomPercentage=100-Math.round((this.object.zoom-this.minZoom)/(this.maxZoom-this.minZoom)*100)},r.getZoomScale=function(){return Math.pow(.95,this.zoomSpeed)},r.isDollyInDisabled=function(){return this.object.isPerspectiveCamera?this.object.fov<=this.minFov:this.object.zoom>=this.maxZoom},r.isDollyOutDisabled=function(){return this.object.isPerspectiveCamera?this.object.isPerspectiveCamera&&this.object.fov>=this.maxFov:this.object.zoom<=this.minZoom},r.dollyIn=function(e){if(this.isDollyInDisabled())return;void 0===e&&(e=this.getZoomScale()),this.object.isPerspectiveCamera?(this.object.fov=Math.max(this.minFov,Math.min(this.maxFov,this.object.fov*e)),this.object.updateProjectionMatrix()):(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/e)),this.object.updateProjectionMatrix()),this.setZoomPercentage();const t=new H5P.Event("zoomin");this.trigger(t)},r.dollyOut=function(e){if(this.isDollyOutDisabled())return;void 0===e&&(e=this.getZoomScale()),this.object.isPerspectiveCamera?(this.object.fov=Math.max(this.minFov,Math.min(this.maxFov,this.object.fov/e)),this.object.updateProjectionMatrix()):(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom*e)),this.object.updateProjectionMatrix()),this.setZoomPercentage();const t=new H5P.Event("zoomout");this.trigger(t)},r.handleMouseWheel=function(e){this.enableZoom&&(e.preventDefault(),e.stopPropagation(),e.deltaY<0?this.dollyIn(this.getZoomScale()):e.deltaY>0&&this.dollyOut(this.getZoomScale()))},r.handleTouchStart=function(e){if(!this.enableZoom)return;if(2!==e.touches.length)return;const t=e.touches[0].pageX-e.touches[1].pageX,o=e.touches[0].pageY-e.touches[1].pageY,n=Math.sqrt(t*t+o*o);this.dollyStart.set(0,n)},r.handleTouchMove=function(e){if(!this.enableZoom)return;if(2!==e.touches.length)return;e.preventDefault(),e.stopPropagation();const t=e.touches[0].pageX-e.touches[1].pageX,o=e.touches[0].pageY-e.touches[1].pageY,n=Math.sqrt(t*t+o*o);this.dollyEnd.set(0,n),this.dollyDelta.set(0,Math.pow(this.dollyEnd.y/this.dollyStart.y,this.zoomSpeed));const i=Math.pow(.95,1.3);this.dollyDelta.y<1?this.dollyOut(i):this.dollyDelta.y>1&&this.dollyIn(i)},r.handleKeyDown=function(e){if(this.enableZoom)switch(e.key){case"-":this.dollyOut();break;case"+":this.dollyIn()}},n}(H5P.EventDispatcher),a=function(){function o(){}var i=o.prototype;return i.buildCamera=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.camera=new H5P.ThreeJS.PerspectiveCamera(this.fieldOfView,this.options.ratio,.1,1e3),this.camera.rotation.order="YXZ",this.setCameraPosition(e.yaw??-Math.PI*(2/3),e.pitch??0)},i.buildRenderers=function(){this.renderer=new H5P.ThreeJS.WebGLRenderer,this.renderer.domElement.classList.add("h5p-three-sixty-scene"),this.renderer.domElement.addEventListener("touchmove",(()=>{})),this.element.append(this.renderer.domElement),this.css2dRenderer=new H5P.ThreeJS.CSS2DRenderer,this.css2dRenderer.domElement.classList.add("h5p-three-sixty-scene","h5p-three-sixty-2d","h5p-three-sixty-controls"),this.element.append(this.css2dRenderer.domElement),this.css3dRenderer=new H5P.ThreeJS.CSS3DRenderer,this.css3dRenderer.domElement.classList.add("h5p-three-sixty-scene","h5p-three-sixty-3d","h5p-three-sixty-controls"),this.element.append(this.css3dRenderer.domElement)},i.buildCameraControls=function(){this.cameraControls=new n(this.css2dRenderer.domElement,this.camera,{friction:400,invert:!0,isCamera:!0,isPanorama:this.options.isPanorama}),this.cameraControls.on("movestart",(e=>{this.cameraControls.startY=this.camera.rotation.y,this.cameraControls.startX=this.camera.rotation.x,this.preventDeviceOrientation=!0,this.trigger(e)})),this.cameraControls.on("move",(o=>{let n=this.cameraControls.startY+o.alpha,i=this.cameraControls.startX+o.beta;const s=t.toRad(this.fieldOfView)/2;if(this.options.isPanorama){const o=(t.toRad(this.fieldOfView)-t.toRad(this.camera.fov))/2,n=Math.min(o,e);i>n?i=n:i<-n&&(i=-n)}else i+s>e?i=e-s:i-s<-e&&(i=-e+s);n%=2*Math.PI,n<0&&(n+=2*Math.PI),this.camera.rotation.y=n,this.camera.rotation.x=i})),this.cameraControls.on("movestop",(e=>{this.preventDeviceOrientation=!1,e.data={yaw:-this.camera.rotation.y,pitch:this.camera.rotation.x},this.trigger(e)}))},i.buildZoomControls=function(){this.zoomControls=new r(this.camera,this.css2dRenderer.domElement,this.options.isPanorama,this.options.enableZoom),this.zoomControls.on("zoomout",(()=>{this.cameraControls&&this.options.isPanorama&&(this.cameraControls.start(),this.cameraControls.move(0,0,400),this.cameraControls.end())}))},o}(),h=function(){function e(){}var t=e.prototype;return t.createSphere=function(){const e=new H5P.ThreeJS.SphereGeometry(10,this.options.segments,this.options.segments);this.applyToSphere(e)},t.createCylinder=function(){const e=new H5P.ThreeJS.CylinderGeometry(10,10,10,this.options.segments,this.options.segments,!0);this.applyToSphere(e)},t.applyToSphere=function(e){e.scale(-1,1,1);const t=new H5P.ThreeJS.MeshBasicMaterial({map:new H5P.ThreeJS.Texture(this.sourceElement,H5P.ThreeJS.UVMapping,H5P.ThreeJS.ClampToEdgeWrapping,H5P.ThreeJS.ClampToEdgeWrapping,H5P.ThreeJS.LinearFilter,H5P.ThreeJS.LinearFilter,H5P.ThreeJS.RGBFormat)});t.map.needsUpdate=!0,this.sphere=new H5P.ThreeJS.Mesh(e,t),this.scene.add(this.sphere)},t.disposeSphere=function(){this.scene.remove(this.sphere),this.sphere.geometry.dispose(),this.sphere.material.dispose(),this.sphere.material.map.dispose(),this.sphere=null},e}();function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}let d=function(e){var o,i;function s(o,n){var i;return i=e.call(this)||this,t.addMixins(s,[a,h]),i.options=t.extend({cameraStartPosition:{pitch:0,yaw:0},ratio:1.7777777777777777,segments:4,isPanorama:!1,enableZoom:!0},n),i.sourceElement=o,i.fieldOfView=n.isPanorama?53:75,i.threeElements=[],i.preventCameraMovement=!1,i.renderLoopId=null,i.element=document.createElement("div"),i.element.classList.add("h5p-three-sixty"),i.scene=new H5P.ThreeJS.Scene,i.cssScene=new H5P.ThreeJS.Scene,i.buildCamera(n.cameraStartPosition),i.buildRenderers(),i.buildCameraControls(),i.buildZoomControls(),i}i=e,(o=s).prototype=Object.create(i.prototype),o.prototype.constructor=o,c(o,i);var r=s.prototype;return r.getRenderers=function(){return[this.css2dRenderer.domElement,this.css3dRenderer.domElement]},r.getCurrentPosition=function(){return{yaw:-this.camera.rotation.y,pitch:this.camera.rotation.x}},r.getCurrentFov=function(){return this.camera.getEffectiveFOV()},r.getElement=function(){return this.element},r.setSegmentNumber=function(e){this.options.segments=e},r.setSourceElement=function(e,t,o){this.sourceElement=e,this.options.isPanorama=t,this.options.enableZoom=o;const n=this.options.isPanorama?53:75;this.camera.fov=n,this.fieldOfView=n,this.camera.updateProjectionMatrix(),this.cameraControls.setPanorama(this.options.isPanorama),this.zoomControls.setEnableZoom(this.options.enableZoom),this.zoomControls.setMaxFov(n)},r.setPreventCameraMovement=function(e){this.preventCameraMovement=e},r.setCameraPosition=function(e,t){this.preventDeviceOrientation||(this.camera.rotation.y=-e,this.camera.rotation.x=this.options.isPanorama?0:t)},r.resize=function(e){this.element.clientWidth&&(e?(this.camera.aspect=e,this.camera.updateProjectionMatrix()):e=this.options.ratio,this.element.style.height=this.element.clientWidth/e+"px",["renderer","css2dRenderer","css3dRenderer"].forEach((e=>{this[e].setSize(this.element.clientWidth,this.element.clientHeight)})))},r.add=function(e,t,o){let i;if(e.classList.contains("render-in-3d")?(i=new H5P.ThreeJS.CSS3DObject(e),i.is3d=!0):i=new H5P.ThreeJS.CSS2DObject(e),this.threeElements.push(i),e.style.left="0",e.style.top="0",e.addEventListener("focus",(e=>{e.defaultPrevented||this.preventCameraMovement||this.setCameraPosition(-i.rotation.y,i.rotation.x),this.setPreventCameraMovement(!1)}),!1),o){const t=new n(e);t.on("movestart",(e=>{t.startY=-i.rotation.y,t.startX=i.rotation.x,this.preventDeviceOrientation=!0,this.trigger(e)})),t.on("move",(e=>{let o=t.startX-e.beta;if(this.options.isPanorama){const e=.42;o=Math.max(Math.min(o,e),-e)}s.setElementPosition(i,{yaw:t.startY+e.alpha,pitch:o})})),t.on("movestop",(t=>{t.data={target:e,yaw:-i.rotation.y,pitch:i.rotation.x},this.preventDeviceOrientation=!1,this.trigger(t)}))}return s.setElementPosition(i,t),this.cssScene.add(i),i},r.remove=function(e){this.threeElements.splice(this.threeElements.indexOf(e),1),this.cssScene.remove(e)},r.find=function(e){return this.threeElements.find((t=>t.element===e))},r.update=function(){this.sphere&&this.disposeSphere(),this.options.isPanorama?this.createCylinder():this.createSphere(),this.triggerFirstRenderEvent=!0},r.updateSource=function(){this.sphere.material.map.needsUpdate=!0},r.focus=function(){this.css2dRenderer.domElement.focus()},r.setTabIndex=function(e){this.css2dRenderer.domElement.tabIndex=e?"0":"-1",this.css3dRenderer.domElement.tabIndex=e?"0":"-1"},r.setAriaLabel=function(e){this.css2dRenderer.domElement.setAttribute("aria-label",e),this.css2dRenderer.domElement.setAttribute("role","document"),this.css3dRenderer.domElement.setAttribute("aria-label",e),this.css3dRenderer.domElement.setAttribute("role","document")},r.startRendering=function(){null===this.renderLoopId&&(window.requestAnimationFrame((()=>{this.css2dRenderer.domElement.insertBefore(this.css3dRenderer.domElement,this.css2dRenderer.domElement.firstChild)})),this.render())},r.stopRendering=function(){cancelAnimationFrame(this.renderLoopId),this.renderLoopId=null},r.render=function(){this.renderer.render(this.scene,this.camera),this.css2dRenderer.render(this.cssScene,this.camera),this.css3dRenderer.render(this.cssScene,this.camera),this.renderLoopId=window.requestAnimationFrame((()=>{this.render()})),this.triggerFirstRenderEvent&&(this.triggerFirstRenderEvent=!1,this.trigger("firstrender"))},s.setElementPosition=function(e,t){e.position.x=800*Math.sin(t.yaw)*Math.cos(t.pitch),e.position.y=800*Math.sin(t.pitch),e.position.z=-800*Math.cos(t.yaw)*Math.cos(t.pitch),e.rotation.order="YXZ",e.rotation.y=-t.yaw,e.rotation.x=+t.pitch},s}(H5P.EventDispatcher);H5P.NDLAThreeSixty=d}();