!function(){"use strict";let t=function(){function t(){}return t.extend=function(){for(let t=1;t<arguments.length;t++)for(let e in arguments[t])Object.prototype.hasOwnProperty.call(arguments[t],e)&&("object"==typeof arguments[0][e]&&"object"==typeof arguments[t][e]?this.extend(arguments[0][e],arguments[t][e]):arguments[0][e]=arguments[t][e]);return arguments[0]},t.htmlDecode=function(t){return(new DOMParser).parseFromString(t,"text/html").documentElement.textContent.replace(/(\r\n|\n|\r)/gm,"")},t.stripHTML=function(t){const e=document.createElement("div");return e.innerHTML=t,e.textContent||e.innerText||""},t.getTopWindow=function(){let e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;if(0===s)return n;try{e=n.parent.location.host===window.location.host}catch(t){e=!1}return e&&n.parent!==n&&n.parent?t.getTopWindow(n.parent,s-1):n},t.formatLanguageCode=function(t){if("string"!=typeof t)return t;const e=t.split("-");return e[0]=e[0].toLowerCase(),e.length>1&&(e[1]=e[1].toUpperCase()),t=e.join("-")},t}();var e=t;let n=function(){function t(n){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.params=n,this.answer=n.answer||null,this.callbacks=e.extend({onClick:()=>{}},s),this.solution=n.solution,this.content=document.createElement("span"),this.content.classList.add("h5p-pick-the-symbols-blank-container");const a=this.answer&&" "!==this.answer?this.answer:"&nbsp;";this.blank=document.createElement("button"),this.blank.classList.add("h5p-pick-the-symbols-blank"),this.blank.setAttribute("tabindex",0),this.blank.setAttribute("title",this.params.l10n.title),this.blank.style.backgroundColor=this.params.color,this.params.slimBlanks&&this.blank.classList.add("h5p-pick-the-symbol-blank-no-border"),this.content.appendChild(this.blank),this.answerInput=document.createElement("span"),this.answerInput.classList.add("h5p-pick-the-symbols-blank-answer"),this.answerInput.innerHTML=a,this.blank.appendChild(this.answerInput),this.correctAnswer=document.createElement("span"),this.correctAnswer.classList.add("h5p-pick-the-symbols-blank-correct-answer"),this.correctAnswer.setAttribute("aria-hidden","true"),this.correctAnswer.innerHTML="",this.content.appendChild(this.correctAnswer),this.blank.addEventListener("click",(()=>{this.callbacks.onClick(this)})),t.HIGHLIGHT_NONE=0,t.HIGHLIGHT_CORRECT=1,t.HIGHLIGHT_WRONG=2,t.HIGHLIGHT_ALL=3}var n=t.prototype;return n.getDOM=function(){return this.content},n.getBlankDOM=function(){return this.blank},n.focus=function(){this.blank.focus()},n.getSolution=function(){return this.solution},n.setAnswer=function(t){t?"&nbsp;"===t||" "===t?(this.answer=" ",this.answerInput.innerHTML="&nbsp;"):(t=e.htmlDecode(t),this.answer=t,this.answerInput.innerHTML=t):(this.answer=null,this.answerInput.innerHTML="&nbsp;")},n.getAnswer=function(){return this.answer},n.getScore=function(){return null===this.answer||" "===this.answer?0:this.solution===this.answer?1:-1},n.setAriaLabel=function(t){this.blank.setAttribute("aria-label",t)},n.setEnabled=function(t){t?this.blank.removeAttribute("disabled"):this.blank.setAttribute("disabled","disabled")},n.showSolution=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.showHighlight(t.highlight),(-1===this.getScore()||0===this.getScore()&&""!==this.solution.trim())&&this.showCorrectSolution(t.answer),t.answer&&0===this.getScore()&&this.hide(),this.showScoreExplanation(t.score)},n.showScoreExplanation=function(t){if(t){if(this.scoreExplanation)return;const t=this.getScore();if(0!==t){const e=new H5P.Question.ScorePoints;this.scoreExplanation=e.getElement(1===t),this.scoreExplanation&&this.blank.appendChild(this.scoreExplanation)}}else{[".h5p-question-plus-one",".h5p-question-minus-one"].forEach((t=>{const e=this.blank.querySelectorAll(t);e&&e.forEach((t=>{t.parentNode.removeChild(t)}))})),this.scoreExplanation=null}},n.showHighlight=function(t){this.blank.style.backgroundColor=this.params.color,this.blank.classList.remove("h5p-pick-the-symbols-blank-state-correct"),this.blank.classList.remove("h5p-pick-the-symbols-blank-state-wrong"),this.blank.classList.remove("h5p-pick-the-symbols-empty-answer"),t&&(1===this.getScore()&&(this.blank.style.backgroundColor="",this.blank.classList.add("h5p-pick-the-symbols-blank-state-correct")),-1===this.getScore()&&(this.blank.style.backgroundColor="",this.blank.classList.add("h5p-pick-the-symbols-blank-state-wrong"),this.answer||this.blank.classList.add("h5p-pick-the-symbols-empty-answer")))},n.showCorrectSolution=function(t){t?(this.correctAnswer.innerHTML=""===this.solution?"&nbsp;":this.solution,this.correctAnswer.style.display="inherit"):(this.correctAnswer.innerHTML="",this.correctAnswer.style.display="none")},n.hide=function(){this.blank.classList.add("h5p-pick-the-symbols-blank-solution"),this.blank.style.backgroundColor=""},n.show=function(){this.blank.classList.remove("h5p-pick-the-symbols-blank-solution"),this.blank.style.backgroundColor=this.params.color},n.reset=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.show(),!0!==t.keepAnswers&&(this.answer=null,this.answerInput.innerHTML="&nbsp;"),!0!==t.keepSolutions&&this.showCorrectSolution(),!0!==t.keepExplanations&&this.showScoreExplanation(),!0!==t.keepHighlights&&this.showHighlight()},n.getCurrentState=function(){return this.getAnswer()},t}(),s=function(){function t(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.params=e.extend({container:document.body,styleBase:"h5p-pick-the-symbols-overlay",position:{offsetHorizontal:0,offsetVertical:0}},t),this.callbacks=n,this.callbacks.onClose=n.onClose||(()=>{}),this.isVisible=!1,this.focusableElements=[],this.overlay=document.createElement("div"),this.overlay.classList.add(`${this.params.styleBase}-outer-wrapper`),this.overlay.classList.add("h5p-pick-the-symbols-invisible"),this.overlay.setAttribute("role","dialog"),this.overlay.setAttribute("aria-label",this.params.l10n.title),this.overlay.setAttribute("aria-modal","true"),this.marker=document.createElement("div"),this.marker.classList.add(`${this.params.styleBase}-marker`),this.overlay.appendChild(this.marker),this.content=document.createElement("div"),this.content.classList.add(`${this.params.styleBase}-content`),this.content.appendChild(this.params.content),this.overlay.appendChild(this.content),this.buttonClose=document.createElement("button"),this.buttonClose.classList.add(`${this.params.styleBase}-button-close`),this.buttonClose.setAttribute("title",this.params.l10n.closeWindow),this.buttonClose.addEventListener("click",(()=>{this.callbacks.onClose()})),this.overlay.appendChild(this.buttonClose),document.addEventListener("focus",(t=>{this.isVisible&&0!==this.focusableElements.length&&this.trapFocus(t)}),!0)}var n=t.prototype;return n.getDOM=function(){return this.overlay},n.getOverlayCoordinates=function(t,e,n){(n=n||{}).offsetHorizontal=n.offsetHorizontal||0,n.offsetVertical=n.offsetVertical||0;const s=e.getBoundingClientRect(),a=t.getBoundingClientRect();let o=0,i=0;switch(n.horizontal){case"before":o=a.left-s.width-n.offsetHorizontal;break;case"after":o=a.left+a.width+n.offsetHorizontal;break;case"left":o=a.left+n.offsetHorizontal;break;case"right":o=a.left+a.width-s.width-n.offsetHorizontal;break;default:o=a.left+a.width/2-s.width/2+n.offsetHorizontal}switch(n.vertical){case"above":i=a.top-s.height-n.offsetVertical;break;case"below":default:i=a.top+a.height+n.offsetVertical;break;case"top":i=a.top+n.offsetVertical;break;case"bottom":i=a.top+a.height-s.height-n.offsetVertical;break;case"centered":i=a.top+a.height/2-s.height/2+n.offsetVertical}const r=document.body.getBoundingClientRect();return(n.noOverflowLeft||n.noOverflowX)&&o<r.x&&(o=r.x),(n.noOverflowRight||n.noOverflowX)&&o+s.width>r.x+r.width&&(o=r.x+r.width-s.width),(n.noOverflowTop||n.noOverflowY)&&i<r.y&&(i=r.y),(n.noOverflowBottom||n.noOverflowY)&&i+s.height>r.y+r.height&&(o=r.y+r.height-s.height),{left:o,top:i}},n.getMarkerCoordinates=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const s=t.getBoundingClientRect(),a=e.getBoundingClientRect();return{left:-n+s.left+(s.width-a.width)/2,top:e.style.top||0}},n.moveTo=function(t){const e=parseFloat(window.getComputedStyle(this.buttonClose).getPropertyValue("width"))+parseFloat(window.getComputedStyle(this.buttonClose).getPropertyValue("right"));let n=this.getOverlayCoordinates(t,this.overlay,this.params.position);return this.overlay.style.left=`${Math.round(n.left-e)}px`,this.overlay.style.top=`${Math.round(n.top)}px`,n=this.getMarkerCoordinates(t,this.marker,Math.round(n.left)),this.marker.style.left=`${Math.round(n.left+e)}px`,{left:this.overlay.style.left,top:this.overlay.style.top}},n.setContent=function(t){for(;this.content.firstChild;)this.content.removeChild(this.content.firstChild);this.content.appendChild(t)},n.trapFocus=function(t){this.isChild(t.target)?this.currentFocusElement=t.target:(this.currentFocusElement===this.focusableElements[0]?this.currentFocusElement=this.focusableElements[this.focusableElements.length-1]:this.currentFocusElement=this.focusableElements[0],this.currentFocusElement.focus())},n.isChild=function(t){const e=t.parentNode;return!!e&&(e===this.overlay||this.isChild(e))},n.updateFocusableElements=function(){this.focusableElements=[].slice.call(this.overlay.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')).filter((t=>"true"!==t.getAttribute("disabled")&&!0!==t.getAttribute("disabled")))},n.show=function(){this.overlay.classList.remove("h5p-pick-the-symbols-invisible"),this.updateFocusableElements(),this.focusableElements.length>0&&this.focusableElements[0].focus(),this.isVisible=!0},n.hide=function(){this.isVisible=!1,this.overlay.classList.add("h5p-pick-the-symbols-invisible")},t}(),a=function(){function t(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.params=t,this.callbacks=e.extend({onOpenOverlay:()=>{}},n),this.blanks=[],this.content=document.createElement("div"),this.content.classList.add("h5p-pick-the-symbols-blank-group")}var s=t.prototype;return s.getDOM=function(){return this.content},s.addBlank=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.amount=Math.max(1,t.amount||1),t.answer&&(t.answer="string"==typeof t.answer||null===t.answer?[t.answer]:t.answer);for(let e=0;e<t.amount;e++){const e=this.params.solution.slice(this.blanks.length,this.blanks.length+1);let s=t.answer?t.answer.slice(this.blanks.length,this.blanks.length+1):null;s&&s.length>0&&(s=null!==s[0]?s[0].slice(0,1):null),t.provideDefaultSpace&&void 0===s&&" "===e&&(s=" ");const a=new n({color:this.params.colorBackground,slimBlanks:this.params.slimBlanks,answer:s,solution:e,l10n:this.params.l10n},{onClick:t=>{this.handleOpenOverlay(t)}});this.blanks.push(a),this.content.appendChild(a.getDOM())}},s.removeBlank=function(){this.blanks.length<2||(this.content.removeChild(this.getBlank(1/0).getDOM()),this.blanks.splice(-1))},s.getBlank=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0;return t=Math.min(Math.max(0,t),this.blanks.length-1),this.blanks[t]},s.getLength=function(){return this.blanks.length},s.handleOpenOverlay=function(t){this.callbacks.onOpenOverlay(this,t)},s.getMaxScore=function(){return this.params.solution.replace(/ /g,"").length},s.getScore=function(){return this.blanks.reduce(((t,e)=>t+e.getScore()),0)},s.getXAPICorrectResponsesPattern=function(){return this.blanks.map((t=>0===t.getScore()?null:""===t.getSolution()?"":t.getSolution())).filter((t=>null!==t)).join("[,]")},s.getXAPIResponse=function(){return this.blanks.map((t=>0!==t.getScore()?t.getAnswer():null)).filter((t=>null!==t)).join("[,]")},s.getXAPIGap=function(){return this.blanks.reduce(((t,e)=>`${t}${0!==e.getScore()?this.params.xAPIPlaceholder:"&nbsp;"}`),"")},s.showSolutions=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t.answer){for(;this.blanks.length<this.params.solution.length;)this.addBlank();if(this.blanks.length>0&&this.params.solution.length>0)for(;this.blanks.length>this.params.solution.length&&null===this.getBlank(1/0).getAnswer();)this.removeBlank()}this.blanks.forEach((e=>{e.showSolution(t)}))},s.reset=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!0!==t.keepAllBlanks)for(;this.blanks.length>1&&(!0!==t.keepAnsweredBlanks||null===this.getBlank(1/0).getAnswer());)this.removeBlank();this.blanks.forEach((e=>{e.reset(t)}))},s.setEnabled=function(t){this.blanks.forEach((e=>{e.setEnabled(t)}))},s.getCurrentState=function(){return this.blanks.map((t=>t.getCurrentState()))},s.focus=function(){this.blanks[0].focus()},t}(),o=function(){function t(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.params=t,this.callbacks=e.extend({onAddBlank:()=>{},onPickSymbol:()=>{},onRemoveBlank:()=>{},onResize:()=>{},onGetVerboseSymbol:()=>{}},n),this.buttons=[],this.hasButtonAddBlank=!1,this.hasButtonRemoveBlank=!1,this.content=document.createElement("div"),this.content.classList.add("h5p-pick-the-symbols-chooser"),this.params.l10n.title){const t=document.createElement("div");t.classList.add("h5p-pick-the-symbols-chooser-title"),t.innerText=e.htmlDecode(this.params.l10n.title),this.content.appendChild(t)}this.symbolButtonsContainer=document.createElement("div"),this.symbolButtonsContainer.classList.add("h5p-pick-the-symbols-chooser-symbol-buttons"),this.content.appendChild(this.symbolButtonsContainer),t.symbols.forEach((t=>{const e=document.createElement("button");e.classList.add("h5p-joubelui-button"),e.classList.add("h5p-pick-the-symbols-chooser-symbol-buttons-button"),e.innerHTML=t,e.setAttribute("title",this.params.l10n.addSymbol.replace(/@symbol/g,"&nbsp;"===t?this.callbacks.onGetVerboseSymbol(t):t)),e.setAttribute("aria-label",this.callbacks.onGetVerboseSymbol(t)),e.addEventListener("click",(()=>{this.callbacks.onPickSymbol(e.innerHTML)})),this.buttons.push(e),this.symbolButtonsContainer.appendChild(e)})),this.blankButtonsContainer=document.createElement("div"),this.blankButtonsContainer.classList.add("h5p-pick-the-symbols-chooser-blank-buttons"),this.blankButtonsContainer.classList.add("h5p-pick-the-symbols-none"),this.content.appendChild(this.blankButtonsContainer),this.buttonRemoveBlank=document.createElement("button"),this.buttonRemoveBlank.classList.add("h5p-joubelui-button"),this.buttonRemoveBlank.classList.add("h5p-pick-the-symbols-chooser-blank-buttons-button"),this.buttonRemoveBlank.classList.add("h5p-pick-the-symbols-remove-blank"),this.buttonRemoveBlank.classList.add("h5p-pick-the-symbols-disabled"),this.buttonRemoveBlank.innerHTML=this.params.l10n.removeBlank,this.buttonRemoveBlank.setAttribute("title",this.params.l10n.removeBlank),this.buttonRemoveBlank.addEventListener("click",(()=>{this.callbacks.onRemoveBlank()})),this.blankButtonsContainer.appendChild(this.buttonRemoveBlank),this.buttonAddBlank=document.createElement("button"),this.buttonAddBlank.classList.add("h5p-joubelui-button"),this.buttonAddBlank.classList.add("h5p-pick-the-symbols-chooser-blank-buttons-button"),this.buttonAddBlank.classList.add("h5p-pick-the-symbols-add-blank"),this.buttonAddBlank.classList.add("h5p-pick-the-symbols-disabled"),this.buttonAddBlank.innerHTML=this.params.l10n.addBlank,this.buttonAddBlank.setAttribute("title",this.params.l10n.addBlank),this.buttonAddBlank.addEventListener("click",(()=>{this.callbacks.onAddBlank()})),this.blankButtonsContainer.appendChild(this.buttonAddBlank)}var n=t.prototype;return n.getDOM=function(){return this.content},n.resize=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.maxWidth=t.maxWidth||1/0;const e=window.getComputedStyle(this.buttons[0]),n=parseFloat(e.getPropertyValue("width")),s=parseFloat(e.getPropertyValue("margin-right")),a=Math.floor((t.maxWidth+s)/(n+s)),o=Math.max(Math.min(this.buttons.length,a),2),i=o*n+(o-1)*s;this.content.style.width=`${i}px`,this.buttons.forEach(((t,e)=>{t.classList.remove("h5p-pick-the-symbols-chooser-button-trailing"),(e+1)%o==0&&t.classList.add("h5p-pick-the-symbols-chooser-button-trailing")})),this.resizeButtons(i)},n.toggleAddButtonAddBlank=function(t){(t="boolean"==typeof t?t:!this.hasButtonAddBlank)?(this.buttonAddBlank.classList.remove("h5p-pick-the-symbols-disabled"),this.buttonAddBlank.removeAttribute("disabled")):(this.buttonAddBlank.classList.add("h5p-pick-the-symbols-disabled"),this.buttonAddBlank.setAttribute("disabled",!0))},n.toggleAddButtonRemoveBlank=function(t){(t="boolean"==typeof t?t:!this.hasButtonRemoveBlank)?(this.buttonRemoveBlank.classList.remove("h5p-pick-the-symbols-disabled"),this.buttonRemoveBlank.removeAttribute("disabled")):(this.buttonRemoveBlank.classList.add("h5p-pick-the-symbols-disabled"),this.buttonRemoveBlank.setAttribute("disabled",!0))},n.toggleBlankButtonsContainer=function(t){(t="boolean"==typeof t?t:!this.hasBlankButtonsContainer)?this.blankButtonsContainer.classList.remove("h5p-pick-the-symbols-none"):this.blankButtonsContainer.classList.add("h5p-pick-the-symbols-none")},n.activateButton=function(t){this.buttons.forEach((e=>{e.innerHTML===t&&e.focus()}))},n.resizeButtons=function(t){this.buttonRemoveBlankWidths=this.buttonRemoveBlankWidths||this.computeButtonWidths(this.buttonRemoveBlank),this.buttonAddBlankWidths=this.buttonAddBlankWidths||this.computeButtonWidths(this.buttonAddBlank),this.buttonRemoveBlankWidths.max+this.buttonAddBlankWidths.max<t?(this.untruncate(this.buttonRemoveBlank),this.untruncate(this.buttonAddBlank)):(this.truncate(this.buttonRemoveBlank),this.truncate(this.buttonAddBlank))},n.truncate=function(t){t.classList.add("truncated"),t.innerHTML=""},n.untruncate=function(t){t.classList.remove("truncated"),t.innerHTML=t.getAttribute("title")},n.computeButtonWidths=function(t){const e={min:0,max:0},n=t.classList.contains("truncated");return t.classList.add("truncated"),e.min=this.getComputedWidth(t),t.classList.remove("truncated"),e.max=this.getComputedWidth(t),n&&t.classList.add("truncated"),e},n.getComputedWidth=function(t){const e=window.getComputedStyle(t),n=parseFloat(e.getPropertyValue("border-left"))+parseFloat(e.getPropertyValue("border-right")),s=parseFloat(e.getPropertyValue("margin-left"))+parseFloat(e.getPropertyValue("margin-right"));return parseFloat(e.getPropertyValue("width"))+s+n},t}(),i=function(){function t(n){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.params=n,this.callbacks=e.extend({onInteracted:()=>{},onResize:()=>{}},i),this.verboseSymbolMapping={"&nbsp;":this.params.a11y.space,".":this.params.a11y.period,"!":this.params.a11y.exclamationPoint,"?":this.params.a11y.questionMark,",":this.params.a11y.comma,"'":this.params.a11y.singleQuote,'"':this.params.a11y.doubleQuote,":":this.params.a11y.colon,";":this.params.a11y.semicolon,"+":this.params.a11y.plus,"-":this.params.a11y.minus,"*":this.params.a11y.asterisk,"/":this.params.a11y.forwardSlash,"\\":this.params.a11y.backwardSlash,"~":this.params.a11y.tilde,"¡":this.params.a11y.invertedExclamationPoint,"¿":this.params.a11y.invertedQuestionMark,"#":this.params.a11y.poundSign,"(":this.params.a11y.leftParanthesis,")":this.params.a11y.rightParanthesis,"^":this.params.a11y.caret,_:this.params.a11y.underscore,"|":this.params.a11y.verticalBar,"‘":this.params.a11y.leftSingleQuotationMark,"‚":this.params.a11y.leftSingleLowQuotationMark,"’":this.params.a11y.rightSingleQuotationMark,"”":this.params.a11y.leftDoubleQuotationMark,"„":this.params.a11y.leftDoubleLowQuotationMark,"“":this.params.a11y.rightDoubleQuotationMark,"‹":this.params.a11y.leftSingleAngleBracket,"›":this.params.a11y.rightSingleAngleBracket,"«":this.params.a11y.leftDoubleAngleBracket,"»":this.params.a11y.rightDoubleAngleBracket,"{":this.params.a11y.leftBrace,"}":this.params.a11y.rightBrace,"[":this.params.a11y.leftBracket,"]":this.params.a11y.rightBracket,"§":this.params.a11y.section,"÷":this.params.a11y.dividedBy,"×":this.params.a11y.multipliedBy,"<":this.params.a11y.lessThan,">":this.params.a11y.greaterThan},this.blankGroups=[],this.nextBlankId=0,this.answerGiven=this.params.previousState&&this.params.previousState.filter((t=>t.length>1||1===t.length&&null!==t[0])).length>0,this.overlayIsOpen=!1;const r=t.deconstructText(n.text,n.symbols);this.textBlankGroups=r.blanks,this.placeholderTemplate=r.placeholder,this.textBlankGroups=this.textBlankGroups.map((t=>t.trim())),this.onlySimpleBlanks=this.textBlankGroups.every((t=>t.length<2)),this.enabled=!0,this.content=document.createElement("div"),this.content.classList.add("h5p-pick-the-symbols-content");const l=document.createElement("div");l.classList.add("h5p-pick-the-symbols-task-description"),l.innerHTML=n.taskDescription,this.content.appendChild(l),this.textContainer=document.createElement("div"),this.textContainer.classList.add("h5p-pick-the-symbols-text-container"),this.content.appendChild(this.textContainer),this.textfield=document.createElement("div"),this.textfield.innerHTML=r.sentence,this.textfield.classList.add("h5p-pick-the-symbols-text"),this.textContainer.appendChild(this.textfield);const h=["&nbsp;"].concat(this.params.symbols.split(""));this.chooser=new o({symbols:h,l10n:{title:this.params.l10n.chooserTitle,addBlank:this.params.l10n.addBlank,addSymbol:this.params.l10n.addSymbol,removeBlank:this.params.l10n.removeBlank},a11y:this.params.a11y},{onPickSymbol:t=>{this.handleChooserPickSymbol(t)},onAddBlank:()=>{this.handleChooserAddBlank()},onRemoveBlank:()=>{this.handleChooserRemoveBlank()},onGetVerboseSymbol:t=>this.getVerboseSymbol(t)}),this.overlay=new s({content:this.chooser.getDOM(),l10n:{title:this.params.l10n.chooserTitle,closeWindow:this.params.l10n.closeWindow},position:{horizontal:"left",noOverflowX:!0,offsetVertical:5}},{onClose:()=>{this.handleCloseOverlay()}}),this.content.appendChild(this.overlay.getDOM());e.getTopWindow(window,1).addEventListener("click",(t=>{this.handleCloseOverlayExternal(t)})),window.addEventListener("click",(t=>{this.handleCloseOverlayExternal(t)})),window.addEventListener("keydown",(t=>{this.handleCloseOverlayExternal(t)})),this.onlySimpleBlanks||this.params.showAllBlanks||this.chooser.toggleBlankButtonsContainer(!0),"undefined"!=typeof NodeList&&NodeList.prototype&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach);this.content.querySelectorAll(".h5p-pick-the-symbols-placeholder").forEach(((t,e)=>{const s=new a({colorBackground:n.colorBackground,slimBlanks:n.slimBlanks,solution:this.textBlankGroups[e],xAPIPlaceholder:this.params.xAPIPlaceholder,l10n:{title:this.params.l10n.blankButtonTitle}},{onOpenOverlay:(t,e)=>{this.handleOpenOverlay(t,e)}});if(this.blankGroups.push(s),this.params.showAllBlanks||n.previousState){const t={};n.previousState&&n.previousState.length>e&&(t.answer=n.previousState[e]),t.amount=t.answer?n.previousState[e].length:this.textBlankGroups[e].length,s.addBlank(t)}else s.addBlank();t.parentNode.replaceChild(s.getDOM(),t)})),this.relabelBlanks()}var n=t.prototype;return n.getDOM=function(){return this.content},n.handleOpenOverlay=function(t,e){if(this.enabled){if(this.currentBlankGroup=t||this.currentBlankGroup,this.currentBlank=e||this.currentBlank,!this.onlySimpleBlanks&&!this.params.showAllBlanks){const t=this.currentBlankGroup.getBlank(0)===this.currentBlank,e=this.currentBlankGroup.getBlank(1/0)===this.currentBlank;this.chooser.toggleAddButtonRemoveBlank(e&&!t),this.chooser.toggleAddButtonAddBlank(e)}this.overlay.show(),this.overlayIsOpen=!0,this.chooser.activateButton(e.getAnswer()),this.resize()}},n.handleCloseOverlay=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.overlayIsOpen=!1,this.overlay.hide(),!0!==t.keepFocus&&this.currentBlank.focus(),this.relabelBlanks(),this.resize()},n.handleCloseOverlayExternal=function(t){if(!this.overlayIsOpen)return;if("keydown"===t.type)return void("Escape"===t.key&&this.handleCloseOverlay());let e=!0,n=t.target;for(;n.parentNode;){if(n.classList.contains("h5p-pick-the-symbols-overlay-outer-wrapper")||n.classList.contains("h5p-pick-the-symbols-blank-group")){e=!1;break}n=n.parentNode}e&&this.handleCloseOverlay()},n.handleChooserPickSymbol=function(t){this.currentBlank.setAnswer(t),this.handleCloseOverlay(),this.answerGiven=!0,this.callbacks.onInteracted()},n.handleChooserAddBlank=function(){this.currentBlankGroup.getBlank()===this.currentBlank&&this.currentBlankGroup.addBlank({provideDefaultSpace:!0}),this.currentBlank=this.currentBlankGroup.getBlank(),this.handleCloseOverlay()},n.handleChooserRemoveBlank=function(){this.currentBlankGroup.getBlank()===this.currentBlank&&this.currentBlankGroup.removeBlank(),this.currentBlank=this.currentBlankGroup.getBlank(),this.handleCloseOverlay()},n.resize=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.overlayIsOpen){const t=this.overlay.moveTo(this.currentBlank.getBlankDOM());this.chooser.resize({maxWidth:this.content.offsetWidth-parseFloat(t.left)});const e=window.getComputedStyle(this.overlay.getDOM()),n=parseFloat(e.getPropertyValue("top")),s=parseFloat(e.getPropertyValue("height"));this.content.offsetHeight<n+s&&(this.content.style.height=`${n+s}px`)}else this.content.style.removeProperty("height");t.bubblingDown||this.callbacks.onResize()},n.showSolutions=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t&&!1===t.score&&(this.solutionShowing=!0),this.blankGroups.forEach((e=>{e.showSolutions(t)}))},n.relabelBlanks=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=this.blankGroups.reduce(((t,e)=>t+e.getLength()),0);let n=1;this.blankGroups.forEach((s=>{s.blanks.forEach((s=>{const a=`${n} ${this.params.a11y.of} ${e}.`,o=s.getScore();let i="";if(!0===t.correctAnswer&&1!==o){const t=(s.getSolution()||"&nbsp;").replace(" ","&nbsp;");i=` ${this.params.a11y.correctAnswer}: ${this.getVerboseSymbol(t)}.`}let r="";!0===t.result&&(r=-1===o?` ${this.params.a11y.answeredIncorrectly}`:1===o?` ${this.params.a11y.answeredCorrectly}`:` ${this.params.a11y.notAnswered}`),""!==r&&"."!==r.slice(-1)&&(r=`${r}.`);const l=` ${this.getVerboseSymbol(s.getAnswer())}`;s.setAriaLabel(`${this.params.a11y.inputBlank} ${a}${i}${r}${l}`),n++}))}))},n.isSolutionShowing=function(){return this.solutionShowing||!1},n.reset=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.keepAllBlanks=t.keepAllBlanks||this.params.showAllBlanks,this.blankGroups.forEach((e=>{e.reset(t)})),this.relabelBlanks(),this.solutionShowing=!1,setTimeout((()=>{this.blankGroups&&this.blankGroups.length>0&&this.blankGroups[0].focus()}),0)},n.toggleEnabled=function(t){(t=void 0===t?!this.enabled:t)?this.textContainer.classList.remove("h5p-pick-the-symbols-disabled"):this.textContainer.classList.add("h5p-pick-the-symbols-disabled"),this.blankGroups.forEach((e=>{e.setEnabled(t)})),this.enabled=t},n.getXAPICorrectResponsesPatterns=function(){return[this.blankGroups.map((t=>t.getXAPICorrectResponsesPattern())).filter((t=>""!==t)).join("[,]")]},n.getXAPIResponses=function(){return this.blankGroups.map((t=>t.getXAPIResponse())).filter((t=>""!==t)).join("[,]")},n.getXAPIGaps=function(){const e=t.getPlaceholderText();return this.blankGroups.reduce(((t,n)=>t.replace(e,n.getXAPIGap())),this.placeholderTemplate)},n.getAnswerGiven=function(){return this.answerGiven},n.getMaxScore=function(){return this.blankGroups.reduce(((t,e)=>t+e.getMaxScore()),0)},n.getScore=function(){const t=this.blankGroups.reduce(((t,e)=>t+e.getScore()),0);return Math.max(0,t)},n.getCurrentState=function(){return this.blankGroups.map((t=>t.getCurrentState()))},n.getVerboseSymbol=function(t){return t=t||"&nbsp;",this.verboseSymbolMapping[t]||t},t.deconstructText=function(n,s){if(!n||!s)return;s=s.split("");let a="";const o=[],i=document.createElement("div");i.innerHTML=n;Array.prototype.slice.call(i.querySelectorAll("p")).map((t=>e.stripHTML(t.innerText))).forEach((e=>{if(""===e)return;const n=[];let i,r;const l=e.split("");for(let e=0;e<l.length;e++){i=i||"",r=r||"";const a=l[e];" "!==a&&-1===s.indexOf(a)?(""!==i&&(o.push(i),n.push(`${t.getWordGroupMarkerStart()}${r}${t.getPlaceholderText()}${t.getWordGroupMarkerEnd()}`),i="",r=""),r=`${r}${a}`):i=`${i}${a}`}if(""!==r||""!==i){let e="";""!==i&&(e=t.getPlaceholderText(),o.push(i)),n.push(`${t.getWordGroupMarkerStart()}${r}${e}${t.getWordGroupMarkerEnd()}`)}a=`${a}<p>${n.join("")}</p>`}));let r=a;for(;-1!==a.indexOf(t.getWordGroupMarkerStart());)a=a.replace(t.getWordGroupMarkerStart(),'<span class="h5p-pick-the-symbols-word-group">'),r=r.replace(t.getWordGroupMarkerStart(),"");for(;-1!==a.indexOf(t.getWordGroupMarkerEnd());)a=a.replace(t.getWordGroupMarkerEnd(),"</span>"),r=r.replace(t.getWordGroupMarkerEnd(),"");return{sentence:a,blanks:o,placeholder:r}},t.getPlaceholderText=function(){return'<span class="h5p-pick-the-symbols-placeholder"></span>'},t.getWordGroupMarkerStart=function(){return"[[[wordgroupstart]]]"},t.getWordGroupMarkerEnd=function(){return"[[[wordgroupend]]]"},t}();function r(t,e){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},r(t,e)}let l=function(t){function s(a,o){var r;let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(r=t.call(this,"pick-the-symbols")||this).params=a,r.contentId=o,r.extras=l,r.params=e.extend({taskDescription:"",text:"",symbols:".?!,:;'\"",behaviour:{enableSolutionsButton:!0,enableRetry:!0,colorBackground:"#ffffff",slimBlanks:!1,infiniteChecking:!0,showAllBlanks:!1},l10n:{checkAnswer:"Check answer",closeWindow:"Close window",continue:"Continue",showSolution:"Show solution",tryAgain:"Retry",blankButtonTitle:"Pick the symbol",chooserTitle:"Pick the symbol",addBlank:"Add blank",addSymbol:"Fill blank with @symbol",removeBlank:"Remove blank"},a11y:{scoreBarLabel:"You got :num out of :total points",inputBlank:"blank input",of:"of",answeredCorrectly:"answered correctly",answeredIncorrectly:"answered incorrectly",notAnswered:"not answered",correctAnswer:"correct answer",space:"space",period:"period",exclamationPoint:"exclamation point",questionMark:"question mark",comma:"comma",singleQuote:"single quote",doubleQuote:"double quote",colon:"colon",semicolon:"semicolon",plus:"plus",minus:"minus",asterisk:"asterisk",forwardSlash:"forward slash",backwardSlash:"backward slash",tilde:"tilde",invertedExclamationPoint:"inverted exclamation point",invertedQuestionMark:"inverted question mark",poundSign:"pound sign",leftParanthesis:"left paranthesis",rightParanthesis:"right paranthesis",caret:"caret",underscore:"underscore",verticalBar:"vertical bar",leftSingleQuotationMark:"left single quotation mark",leftSingleLowQuotationMark:"left single low quotation mark",rightSingleQuotationMark:"right single quotation mark",leftDoubleQuotationMark:"left double quotation mark",leftDoubleLowQuotationMark:"left double low quotation mark",rightDoubleQuotationMark:"right double quotation mark",leftSingleAngleBracket:"left single angle bracket",rightSingleAngleBracket:"right single angle bracket",leftDoubleAngleBracket:"left double angle bracket",rightDoubleAngleBracket:"right double angle bracket",leftBrace:"left brace",rightBrace:"right brace",leftBracket:"left bracket",rightBracket:"right bracket",section:"section",dividedBy:"divided by",multipliedBy:"multipled by",lessThan:"less than",greaterThan:"greater than"}},r.params);for(const t in r.params.l10n)r.params.l10n[t]=e.htmlDecode(r.params.l10n[t]),r.params.l10n[t]=e.stripHTML(r.params.l10n[t]);for(const t in r.params.a11y)r.params.a11y[t]=e.htmlDecode(r.params.a11y[t]),r.params.l10n[t]=e.stripHTML(r.params.l10n[t]);r.params.symbols=e.htmlDecode(r.params.symbols).replace(/\s/g,"").split("").reduce(((t,e)=>-1===t.indexOf(e)?`${t}${e}`:t),"");const h=l.metadata&&l.metadata.defaultLanguage||"en";return r.languageTag=e.formatLanguageCode(h),r.previousState=r.extras.previousState||{},r.registerDomElements=()=>{""!==r.params.text?(r.content=new i({taskDescription:r.params.taskDescription,text:r.params.text,symbols:r.params.symbols,colorBackground:r.params.behaviour.colorBackground,slimBlanks:r.params.behaviour.slimBlanks,showAllBlanks:r.params.behaviour.showAllBlanks,previousState:r.previousState.answers,xAPIPlaceholder:s.XAPI_PLACEHOLDER,l10n:{blankButtonTitle:r.params.l10n.blankButtonTitle,chooserTitle:r.params.l10n.chooserTitle,addBlank:r.params.l10n.addBlank,addSymbol:r.params.l10n.addSymbol,closeWindow:r.params.l10n.closeWindow,removeBlank:r.params.l10n.removeBlank},a11y:r.params.a11y},{onInteracted:()=>{r.handleInteracted()},onResize:()=>{r.resize({bubblingUp:!0})}}),r.setContent(r.content.getDOM()),r.addButtons()):r.setContent("<p>You forgot to enter text.<p>")},r.addButtons=()=>{r.addButton("check-answer",r.params.l10n.checkAnswer,(()=>{r.content.toggleEnabled(!1),r.trigger(r.getXAPIAnswerEvent()),r.hideButton("check-answer"),r.params.behaviour.infiniteChecking&&r.getScore()<r.getMaxScore()&&r.showButton("continue"),r.content.handleCloseOverlay({keepFocus:!0}),r.content.relabelBlanks({result:!0}),r.content.showSolutions({highlight:n.HIGHLIGHT_CORRECT,score:!0});const t=H5P.Question.determineOverallFeedback(r.params.overallFeedback,r.getScore()/r.getMaxScore());r.setFeedback(t,r.getScore(),r.getMaxScore(),e.stripHTML(r.params.a11y.scoreBarLabel.replace("@score",":num").replace("@total",":total"))),r.params.behaviour.infiniteChecking||r.content.toggleEnabled(!1),r.params.behaviour.enableSolutionsButton&&r.getScore()<r.getMaxScore()&&r.showButton("show-solution"),r.params.behaviour.enableRetry&&r.showButton("try-again")}),!0,{},{}),r.addButton("continue",r.params.l10n.continue,(()=>{r.reset({keepAnswers:!0,keepAnsweredBlanks:r.content.isSolutionShowing(),keepAllBlanks:!r.content.isSolutionShowing()})}),!1,{},{}),r.addButton("show-solution",r.params.l10n.showSolution,(()=>{r.showSolutions()}),!1,{},{}),r.addButton("try-again",r.params.l10n.tryAgain,(()=>{r.params.behaviour.infiniteChecking||r.showButton("check-answer"),r.hideButton("show-solution"),r.hideButton("try-again"),r.resetTask(),r.params.behaviour.infiniteChecking||r.content.toggleEnabled(!0),r.trigger("resize")}),!1,{},{})},r.on("resize",(()=>{r.resize()})),r.resize=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r.content&&(t.bubblingUp?r.trigger("resize"):r.content.resize({bubblingDown:!0}))},r.getAnswerGiven=()=>r.content.getAnswerGiven(),r.getScore=()=>r.content.getScore(),r.getMaxScore=()=>r.content.getMaxScore(),r.showSolutions=()=>{r.content.showSolutions({highlight:n.HIGHLIGHT_ALL,answer:!0,score:!1}),r.content.relabelBlanks({result:!0,correctAnswer:!0}),r.trigger("resize")},r.resetTask=()=>{r.reset()},r.reset=t=>{r.showButton("check-answer"),r.hideButton("continue"),r.hideButton("show-solution"),r.hideButton("try-again"),r.removeFeedback(),r.content.reset(t),r.content.toggleEnabled(!0)},r.getXAPIData=()=>({statement:r.getXAPIAnswerEvent().data.statement}),r.getXAPIAnswerEvent=()=>{const t=r.createXAPIEvent("answered");return t.setScoredResult(r.getScore(),r.getMaxScore(),r,!0,r.isPassed()),t.data.statement.result.response=r.content.getXAPIResponses(),t},r.createXAPIEvent=t=>{const n=r.createXAPIEventTemplate(t);return e.extend(n.getVerifiedStatementValue(["object","definition"]),r.getxAPIDefinition()),n},r.getxAPIDefinition=()=>{const t={name:{}};return t.name[r.languageTag]=r.getTitle(),t.name["en-US"]=t.name[r.languageTag],t.description={},t.description[r.languageTag]=`${r.getDescription()}${r.content.getXAPIGaps()}`,t.description["en-US"]=t.description[r.languageTag],t.type="http://adlnet.gov/expapi/activities/cmi.interaction",t.interactionType="fill-in",t.correctResponsesPattern=r.content.getXAPICorrectResponsesPatterns(),t},r.isPassed=()=>r.getScore()===r.getMaxScore(),r.getTitle=()=>{let t;return r.extras.metadata&&(t=r.extras.metadata.title),t=t||s.DEFAULT_DESCRIPTION,H5P.createTitle(t)},r.getDescription=()=>r.params.taskDescription||s.DEFAULT_DESCRIPTION,r.getCurrentState=()=>({answers:r.content.getCurrentState()}),r.handleInteracted=()=>{r.triggerXAPI("interacted")},r}var a,o;return o=t,(a=s).prototype=Object.create(o.prototype),a.prototype.constructor=a,r(a,o),s}(H5P.Question);l.DEFAULT_DESCRIPTION="Pick the Symbols",l.XAPI_PLACEHOLDER="__________",H5P.PickTheSymbols=l}();